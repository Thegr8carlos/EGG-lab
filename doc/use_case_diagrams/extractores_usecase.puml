@startuml
title Casos de Uso - Pagina Extractores (extractores.py)

' Actor
actor "Usuario\nInvestigador" as user #lightblue

' Sistema boundary
rectangle "Sistema EGG-lab\n(Pagina Extractores)" {

  ' Casos de uso principales
  usecase "Seleccionar Archivo\nEEG" as UC1 #lightgreen
  usecase "Filtrar por\nClase" as UC2 #lightblue
  usecase "Seleccionar\nCanales" as UC3 #yellow
  usecase "Visualizar Señal\nOriginal" as UC4 #pink
  usecase "Visualizar Señal\nTransformada" as UC5 #lavender
  usecase "Ver Historial\nde Pipeline" as UC6 #lightcyan
  usecase "Toggle Auto-aplicar\nTransformadas" as UC7 #lightyellow

  ' Casos de uso de navegacion
  usecase "Navegar entre\nPaginas de Canales" as UC8 #lightyellow
  usecase "Aplicar Transformadas\ndel Pipeline" as UC9 #lightyellow
  usecase "Ver JSON de\nTransformada" as UC10 #lightgray
}

' Sistemas externos
rectangle "Backend" {
  usecase "Dataset.get_events_by_class()" as BACK1 #lavender
  usecase "Dataset.load_event_with_channels()" as BACK2 #lavender
  usecase "Experiment.apply_history_pipeline()" as BACK3 #lavender
  usecase "Experiment.get_experiment_summary()" as BACK4 #lavender
}

' Relaciones usuario -> casos de uso
user --> UC1 : "Seleccionar en Sidebar"
user --> UC2 : "Clic en boton clase"
user --> UC3 : "Marcar canales"
user --> UC8 : "Navegar paginacion"
user --> UC7 : "Toggle ON/OFF"
user --> UC10 : "Clic en JSON"

' Relaciones include
UC1 ..> BACK1 : <<include>>
UC1 ..> UC4 : <<include>>

UC2 ..> BACK1 : <<include>>
UC2 ..> UC4 : <<include>>

UC3 ..> BACK2 : <<include>>

UC4 ..> UC9 : <<extend>>\nsi auto-apply ON

UC5 ..> BACK3 : <<include>>

UC6 ..> BACK4 : <<include>>

UC9 ..> BACK3 : <<include>>
UC9 ..> UC5 : trigger

UC10 ..> BACK4 : <<include>>

' Notas
note right of UC1
  Flujo:
  1. Selecciona archivo en Sidebar
  2. Carga metadata del dataset
  3. Carga primer evento de clase
  4. Renderiza graficos originales
  5. Si auto-apply ON, aplica pipeline
end note

note right of UC2
  Flujo:
  1. Lista clases del dataset
  2. Usuario hace clic en clase
  3. Filtra eventos por clase
  4. Carga primer evento filtrado
  5. Actualiza visualizaciones
end note

note right of UC3
  Flujo:
  1. Carga nombres de canales
  2. Usuario marca/desmarca canales
  3. Carga evento solo con canales
     seleccionados
  4. Actualiza contador
end note

note bottom of UC5
  Flujo:
  1. Verifica datos transformados
  2. Si auto-apply ON, aplica pipeline
  3. Usa cache si disponible
  4. Detecta y aplana arrays 3D
  5. Renderiza columna derecha
  6. Muestra indicadores de estado
end note

note bottom of UC9
  Flujo:
  1. Lee historial del experimento
  2. Aplica transformadas en orden
  3. Usa cache si disponible
  4. Guarda intermedios opcionales
  5. Retorna señal transformada
end note

' Estilos
skinparam usecase {
  BackgroundColor lightblue
  BorderColor darkblue
  ArrowColor darkblue
}

skinparam actor {
  BackgroundColor lightblue
  BorderColor darkblue
}

skinparam note {
  BackgroundColor lightyellow
  BorderColor orange
}

@enduml
